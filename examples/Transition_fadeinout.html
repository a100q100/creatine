<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Creatine Example: FadeInOut Transition</title>

    <script src="../_assets/libs/easeljs-NEXT.combined.js"></script>
    <script src="../_assets/libs/tweenjs-NEXT.combined.js"></script>
    <script src="../_assets/libs/preloadjs-NEXT.combined.js"></script>

    <script src="../src/creatine.js"></script>
    <script src="../src/helpers/functions.js"></script>
    <script src="../src/scene/Director.js"></script>
    <script src="../src/scene/Scene.js"></script>
    <script src="../src/transitions/FadeInOut.js"></script>

    <script src="../_assets/js/base.js"></script>
    <link href="../_assets/css/base.css" rel="stylesheet">
</head>

<body onLoad="init();">
    <canvas id="canvas" width="640" height="480">JavaScript Not Enabled.</canvas>
</body>
</html>

<script type="text/javascript">
    var canvas     = null;
    var stage      = null;
    var director   = null;
    var scenes     = null;
    var transition = null;
    var idxScene   = null;
    var manifest = [
        '../_assets/img/morning.png',
        '../_assets/img/evening.png',
        '../_assets/img/night.png'
    ];

    function init() {
        canvas   = document.getElementById('canvas');
        stage    = new createjs.Stage(canvas);
        director = new creatine.Director(stage);

        createjs.Ticker.setFPS(60);
        createjs.Ticker.addEventListener('tick', onTick);

        var img = new Image();
        for(i=0; i<manifest.length; i++) {
            img.src = manifest[i];
        }
        img.onload = onLoadComplete;

        director.push(new RandomScene(0, 0, 640, 480, 'Loading...'));
    }

    function createScene(img) {
        var scene = new creatine.Scene();
        var background = new createjs.Bitmap(manifest[img]);
        scene.addChild(background);
        
        return scene;
    }

    function onLoadComplete(event) {
        stage.addEventListener('stagemousedown', onClick);

        transition = new creatine.transitions.FadeInOut();
        scenes = [
            createScene(0),
            createScene(1),
            createScene(2),
        ]

        idxScene = 0;
        onClick();
    }

    function onTick() {
        stage.update();
    }

    function onClick() {
        if (director.inTransition) return;

        director.replace(
            scenes[idxScene],
            transition
        );

        idxScene++;
        if (idxScene >= 3) {
            idxScene = 0;
        }
    }
</script>