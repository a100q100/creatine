<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Creatine Example: Director and Scenes</title>

    <script src="../_assets/libs/easeljs-NEXT.combined.js"></script>
    <script src="../_assets/libs/tweenjs-NEXT.combined.js"></script>
    <script src="../_assets/libs/preloadjs-NEXT.combined.js"></script>

    <script src="../src/creatine.js"></script>
    <script src="../src/scene/Director.js"></script>
    <script src="../src/scene/Scene.js"></script>
    
    <script src="../_assets/js/base.js"></script>
    <link href="../_assets/css/base.css" rel="stylesheet">
</head>

<body onLoad="init();">
    <canvas id="canvas" width="640" height="480">JavaScript Not Enabled.</canvas>
    <div class="center">
        <button onclick="replaceScene();">Replace</button>
        <button onclick="pushScene();">Push</button>
        <button onclick="popScene();">Pop</button>
        <button onclick="clearStack();">Clear stack</button>
    </div>
</body>
</html>

<script type="text/javascript">
    var canvas    = null;
    var stage     = null;
    var director = null;
    var counter = 1;

    function init() {
        canvas = document.getElementById('canvas');
        stage = new createjs.Stage(canvas);
        director = new creatine.Director(stage);

        // You can add an object directly to stage, just be careful!
        var bottomText = new createjs.Text('Bottom Layer', '64px Arial', '#38B2CE');
        bottomText.textAlign = 'center';
        bottomText.x = 320;
        bottomText.y = 400;
        this.stage.addChild(bottomText);

        pushScene();

        var topText = new createjs.Text('Top Layer', '64px Arial', '#333333');
        topText.textAlign = 'center';
        topText.x = 320;
        topText.y = 0
        this.stage.addChild(topText);

        createjs.Ticker.addEventListener('tick', onTick);
        document.addEventListener("keypress", onKeyPress);
    }

    function onTick(event) {
        stage.update();
    }

    function onKeyPress(event) {
        switch (event.keyCode) {
            case 114:
                replaceScene();
                break;
            case 112:
                pushScene();
                break;
            case 111:
                popScene();
                break;
            case 99:
                clearStack();
                break;
        }
    }

    // Callbacks
    function pushScene() {
        director.push(createScene());
    }

    function popScene() {
        director.pop();
    }

    function replaceScene() {
        director.replace(createScene());
    }

    function clearStack() {
        director.clearStack();
    }
    // ---------
    
    function createScene() {
        var scene = new RandomScene(
            Math.floor(Math.random()*320),
            Math.floor(Math.random()*240),
            Math.floor(Math.random()*270)+50,
            Math.floor(Math.random()*190)+50,
            counter
        );
        
        scene.id = counter;
        scene.on('scenepause', function() {
            console && console.log('Event: Scene '+scene.id+' Pause');
        });

        scene.on('sceneresume', function() {
            console && console.log('Event: Scene '+scene.id+' Resume');
        });

        scene.on('sceneenter', function() {
            console && console.log('Event: Scene '+scene.id+' Enter');
        });

        scene.on('sceneexit', function() {
            console && console.log('Event: Scene '+scene.id+' Exit');
        });

        counter++;

        return scene
    }

</script>